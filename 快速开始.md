# 快速开始指南

## 🚀 项目已启动，可以开始测试了！

### 当前状态

✅ **后端服务**: 运行在 http://localhost:9000  
✅ **数据库**: MySQL 运行在端口 9306  
✅ **phpMyAdmin**: http://localhost:9080  
✅ **数据库表**: 已自动创建  
✅ **测试数据**: 可运行初始化脚本创建

## 📱 小程序测试步骤

### 1. 打开微信开发者工具

1. 启动微信开发者工具
2. 选择"导入项目"
3. 选择 `miniprogram` 目录
4. 填写 AppID（可使用测试号）

### 2. 配置开发环境

#### 修改 API 地址（如果需要）

编辑 `miniprogram/app.js`，确认 API 地址：

```javascript
apiBaseUrl: 'http://localhost:9000/api'
```

**注意**: 
- 真机调试时，`localhost` 无法访问
- 需要使用局域网 IP，例如：`http://192.168.1.100:9000/api`
- 或使用 ngrok 等工具进行内网穿透

#### 开发环境设置

在微信开发者工具中：
1. 设置 → 项目设置 → 本地设置
2. 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"

### 3. 添加 TabBar 图标

在 `miniprogram/images/` 目录下添加图标：
- `home.png` / `home-active.png`
- `profile.png` / `profile-active.png`

如果暂时没有图标，可以：
1. 使用在线图标生成工具
2. 暂时注释掉 `app.json` 中的 `tabBar.iconPath` 配置

### 4. 创建测试数据（可选）

运行初始化脚本创建测试数据：

```bash
docker-compose exec api node scripts/init-data.js
```

这会创建：
- 测试用户（管理员和普通用户）
- 测试 Banner
- 测试课程和记录

### 5. 测试功能

#### 测试登录
1. 打开小程序
2. 点击"我的" tab
3. 点击"立即登录"
4. 进行微信授权

**注意**: 开发环境可以使用测试 openid，但需要修改后端代码或使用真实的微信登录

#### 测试首页
1. 查看 Banner 轮播图
2. 查看课程列表（需要先登录）

#### 测试课程管理
1. 点击课程卡片进入详情
2. 查看记录列表
3. 点击"新增记录"按钮

#### 测试记录管理
1. 点击记录进入详情
2. 编辑备注
3. 上传图片
4. 预览和删除图片

## 🔧 后端 API 测试

### 使用 curl 测试

```bash
# 健康检查
curl http://localhost:9000/health

# 获取 Banner 列表
curl http://localhost:9000/api/banners

# 微信登录（需要真实的 code）
curl -X POST http://localhost:9000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "code": "微信登录code",
    "userInfo": {
      "nickName": "测试用户",
      "avatarUrl": "https://example.com/avatar.jpg"
    }
  }'
```

### 使用 Postman 测试

1. 导入 API 文档
2. 设置 Base URL: `http://localhost:9000/api`
3. 测试各个接口

## 📊 数据库管理

### 访问 phpMyAdmin

1. 打开浏览器访问: http://localhost:9080
2. 登录信息:
   - 服务器: `mysql`
   - 用户名: `root`
   - 密码: `course123456`

### 查看数据

- 查看用户表: `users`
- 查看课程表: `courses`
- 查看记录表: `records`
- 查看 Banner 表: `banners`

## 🐛 常见问题

### 1. 小程序无法连接 API

**问题**: 网络请求失败

**解决方案**:
- 确认后端服务运行正常: `docker-compose ps`
- 检查 API 地址是否正确
- 开发环境勾选"不校验合法域名"
- 真机调试时使用局域网 IP 或内网穿透

### 2. 登录失败

**问题**: 微信登录返回错误

**解决方案**:
- 确认 `.env` 文件中配置了正确的 `WX_APPID` 和 `WX_SECRET`
- 检查微信开发者工具中的 AppID 是否正确
- 开发环境可以使用测试数据

### 3. 数据库连接失败

**问题**: API 服务无法连接数据库

**解决方案**:
- 检查 MySQL 容器是否运行: `docker-compose ps`
- 查看日志: `docker-compose logs mysql`
- 确认 `.env` 文件中的数据库配置正确

### 4. 图片上传失败

**问题**: 上传图片到 COS 失败

**解决方案**:
- 确认 `.env` 文件中配置了正确的 COS 凭证
- 检查 COS 配置是否正确
- 查看 API 日志: `docker-compose logs api`

## 📝 下一步

1. ✅ 服务已启动
2. ✅ 代码已实现
3. 🔄 进行功能测试
4. 🔄 优化用户体验
5. 🔄 添加更多功能

## 📚 相关文档

- [测试说明](./测试说明.md)
- [API 接口文档](./docs/api/README.md)
- [后端开发文档](./docs/backend/README.md)
- [前端开发文档](./docs/frontend/README.md)

